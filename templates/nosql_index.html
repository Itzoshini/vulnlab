{% extends "base.html" %}

{% block title %}NoSQL Injection Lab - VulnLab{% endblock %}

{% block content %}
<div class="lab-container">
    <div class="lab-header">
        <h1>üíâ NoSQL Injection Lab</h1>
        <p class="lab-subtitle">Practice NoSQL injection attacks at different difficulty levels</p>
    </div>

    <div class="lab-info">
        <h3>üìñ About NoSQL Injection</h3>
        <p>NoSQL injection is a vulnerability where attackers can inject malicious queries into NoSQL databases (like MongoDB). 
        Unlike SQL injection, NoSQL injection uses operators like <code>$ne</code>, <code>$gt</code>, <code>$regex</code> to manipulate queries.</p>
        <p><strong>Your Goal:</strong> Exploit the login form at each level to bypass authentication!</p>
    </div>

    <div class="levels-grid">
        {% for level in levels %}
        <div class="level-card {% if not level.unlocked %}locked{% endif %} {% if level.completed %}completed{% endif %}">
            <div class="level-header">
                <span class="level-number">{{ loop.index }}</span>
                <h3>{{ level.name }}</h3>
                {% if level.completed %}
                <span class="badge-completed">‚úÖ Completed</span>
                {% elif not level.unlocked %}
                <span class="badge-locked">üîí Locked</span>
                {% else %}
                <span class="badge-active">üîì Available</span>
                {% endif %}
            </div>
            <div class="level-description">
                {% if level.level == 'easy' %}
                    Basic NoSQL operators are accepted. Try using <code>$ne</code> or <code>$gt</code>.
                {% elif level.level == 'medium' %}
                    Requires more sophisticated operators. MongoDB query operators needed.
                {% elif level.level == 'hard' %}
                    Advanced techniques required. Operator combinations needed.
                {% elif level.level == 'impossible' %}
                    Secure implementation. No injection possible (educational reference).
                {% endif %}
            </div>
            <div class="level-actions">
                {% if level.unlocked %}
                    <a href="{{ url_for('nosql_level', level=level.level) }}" class="btn btn-primary">Start Challenge ‚Üí</a>
                {% else %}
                    <button class="btn btn-disabled" disabled>Complete previous level first</button>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>

    <div class="back-link">
        <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">‚Üê Back to Dashboard</a>
    </div>
</div>
{% endblock %}
