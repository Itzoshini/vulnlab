{% extends "base.html" %}

{% block title %}XSS Lab - VulnLab{% endblock %}

{% block content %}
<div class="lab-container">
    <div class="lab-header">
        <h1>‚ö° XSS (Cross-Site Scripting) Lab</h1>
        <p class="lab-subtitle">Practice XSS attacks - Reflected and Stored XSS at different difficulty levels</p>
    </div>

    <div class="lab-info">
        <h3>üìñ About XSS</h3>
        <p>Cross-Site Scripting (XSS) allows attackers to inject malicious JavaScript code into web pages. 
        This code executes in the victim's browser, potentially stealing cookies, session tokens, or performing actions on behalf of the user.</p>
        <p><strong>Types:</strong></p>
        <ul>
            <li><strong>Stored XSS:</strong> Malicious script is stored in the database and executed when other users view the page</li>
            <li><strong>Reflected XSS:</strong> Malicious script is reflected in the response (via URL parameters, forms, etc.)</li>
        </ul>
        <p><strong>Your Goal:</strong> Inject JavaScript payloads that execute in the browser!</p>
    </div>

    <div class="levels-grid">
        {% for level in levels %}
        <div class="level-card {% if not level.unlocked %}locked{% endif %} {% if level.completed %}completed{% endif %}">
            <div class="level-header">
                <span class="level-number">{{ loop.index }}</span>
                <h3>{{ level.name }}</h3>
                {% if level.completed %}
                <span class="badge-completed">‚úÖ Completed</span>
                {% elif not level.unlocked %}
                <span class="badge-locked">üîí Locked</span>
                {% else %}
                <span class="badge-active">üîì Available</span>
                {% endif %}
            </div>
            <div class="level-description">
                {% if level.level == 'easy' %}
                    Basic <code>&lt;script&gt;</code> tags are not filtered. Simple XSS payloads work.
                {% elif level.level == 'medium' %}
                    Script tags are filtered. Try event handlers like <code>onerror</code>, <code>onload</code>.
                {% elif level.level == 'hard' %}
                    Multiple filters in place. Advanced techniques required (SVG, iframe, encoding).
                {% elif level.level == 'impossible' %}
                    Secure implementation with full input sanitization and output encoding.
                {% endif %}
            </div>
            <div class="level-actions">
                {% if level.unlocked %}
                    <a href="{{ url_for('xss_level', level=level.level) }}" class="btn btn-primary">Start Challenge ‚Üí</a>
                {% else %}
                    <button class="btn btn-disabled" disabled>Complete previous level first</button>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>

    <div class="back-link">
        <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">‚Üê Back to Dashboard</a>
    </div>
</div>
{% endblock %}
